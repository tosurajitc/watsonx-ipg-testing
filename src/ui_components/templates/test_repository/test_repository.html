{% extends "base.html" %}
{% load static %}

{% block title %}Test Repository | Watsonx for IPG Testing{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/test_repository/test_repository.css' %}">
{% endblock %}

{% block content_title %}Test Repository{% endblock %}

{% block breadcrumb %}
<li class="breadcrumb-item"><a href="{% url 'ui_components:dashboard' %}">Home</a></li>
<li class="breadcrumb-item active" aria-current="page">Test Repository</li>
{% endblock %}

{% block content %}
<div class="row mb-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="card-title mb-0">Connection Status</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-4">
                        <div class="connection-status-box">
                            <div class="d-flex align-items-center">
                                <div class="connection-icon sharepoint-icon">
                                    <i class="fab fa-microsoft"></i>
                                </div>
                                <div class="connection-details">
                                    <h6 class="mb-0">SharePoint</h6>
                                    <div id="sharepoint-connection-status" class="connection-status-indicator">
                                        <span class="badge" data-connection-status="disconnected">
                                            <i class="fas fa-times-circle me-1"></i>Disconnected
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="connection-status-box">
                            <div class="d-flex align-items-center">
                                <div class="connection-icon jira-icon">
                                    <i class="fab fa-jira"></i>
                                </div>
                                <div class="connection-details">
                                    <h6 class="mb-0">JIRA</h6>
                                    <div id="jira-connection-status" class="connection-status-indicator">
                                        <span class="badge" data-connection-status="disconnected">
                                            <i class="fas fa-times-circle me-1"></i>Disconnected
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="connection-status-box">
                            <div class="d-flex align-items-center">
                                <div class="connection-icon alm-icon">
                                    <i class="fas fa-project-diagram"></i>
                                </div>
                                <div class="connection-details">
                                    <h6 class="mb-0">ALM</h6>
                                    <div id="alm-connection-status" class="connection-status-indicator">
                                        <span class="badge" data-connection-status="disconnected">
                                            <i class="fas fa-times-circle me-1"></i>Disconnected
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Repository Browser -->
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="card-title mb-0">Repository Browser</h5>
                <div>
                    <button class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#importTestCaseModal">
                        <i class="fas fa-upload me-1"></i> Import Test Case
                    </button>
                    <button class="btn btn-sm btn-success" data-bs-toggle="modal" data-bs-target="#compareRepositoryModal">
                        <i class="fas fa-exchange-alt me-1"></i> Compare with Repository
                    </button>
                </div>
            </div>
            <div class="card-body">
                <!-- Filters Section -->
                <div class="filters-section mb-4">
                    <div class="row g-3">
                        <div class="col-md-3">
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-search"></i></span>
                                <input type="text" class="form-control" id="search-test-cases" placeholder="Search by ID or keyword...">
                            </div>
                        </div>
                        <div class="col-md-2">
                            <select class="form-select" id="filter-status">
                                <option value="">All Statuses</option>
                                <option value="active">Active</option>
                                <option value="maintenance">Under Maintenance</option>
                                <option value="obsolete">Obsolete</option>
                            </select>
                        </div>
                        <div class="col-md-2">
                            <select class="form-select" id="filter-owner">
                                <option value="">All Owners</option>
                                <option value="john.doe">John Doe</option>
                                <option value="jane.smith">Jane Smith</option>
                                <option value="alex.wilson">Alex Wilson</option>
                            </select>
                        </div>
                        <div class="col-md-2">
                            <select class="form-select" id="filter-type">
                                <option value="">All Types</option>
                                <option value="manual">Manual</option>
                                <option value="automated">Automated</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <div class="d-flex justify-content-end gap-2">
                                <button class="btn btn-outline-primary" id="apply-filters">
                                    <i class="fas fa-filter me-1"></i> Apply
                                </button>
                                <button class="btn btn-outline-secondary" id="reset-filters">
                                    <i class="fas fa-sync-alt me-1"></i> Reset
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tabs Navigation -->
                <ul class="nav nav-tabs" id="repositoryTabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="all-cases-tab" data-bs-toggle="tab" data-bs-target="#all-cases" type="button" role="tab" aria-controls="all-cases" aria-selected="true">
                            All Test Cases
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="matched-cases-tab" data-bs-toggle="tab" data-bs-target="#matched-cases" type="button" role="tab" aria-controls="matched-cases" aria-selected="false">
                            Matched Cases <span class="badge bg-primary rounded-pill">12</span>
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="needs-modification-tab" data-bs-toggle="tab" data-bs-target="#needs-modification" type="button" role="tab" aria-controls="needs-modification" aria-selected="false">
                            Cases Needing Modification <span class="badge bg-warning rounded-pill">7</span>
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="new-cases-tab" data-bs-toggle="tab" data-bs-target="#new-cases" type="button" role="tab" aria-controls="new-cases" aria-selected="false">
                            Newly Added Cases <span class="badge bg-success rounded-pill">5</span>
                        </button>
                    </li>
                </ul>

                <!-- Tab Content -->
                <div class="tab-content" id="repositoryTabsContent">
                    <!-- All Test Cases Tab -->
                    <div class="tab-pane fade show active" id="all-cases" role="tabpanel" aria-labelledby="all-cases-tab">
                        <div class="table-responsive mt-3">
                            <table class="table table-striped table-hover" id="all-test-cases-table">
                                <thead>
                                    <tr>
                                        <th scope="col">ID</th>
                                        <th scope="col">Title</th>
                                        <th scope="col">Status</th>
                                        <th scope="col">Owner</th>
                                        <th scope="col">Type</th>
                                        <th scope="col">Last Modified</th>
                                        <th scope="col">Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>TC-1001</td>
                                        <td>Verify login with valid credentials</td>
                                        <td><span class="badge bg-success">Active</span></td>
                                        <td>John Doe</td>
                                        <td><span class="badge bg-info">Automated</span></td>
                                        <td>2025-04-25</td>
                                        <td>
                                            <div class="btn-group btn-group-sm" role="group">
                                                <button type="button" class="btn btn-outline-primary view-test-case" data-id="TC-1001" title="View"><i class="fas fa-eye"></i></button>
                                                <button type="button" class="btn btn-outline-success execute-test-case" data-id="TC-1001" title="Execute"><i class="fas fa-play"></i></button>
                                                <button type="button" class="btn btn-outline-warning edit-test-case" data-id="TC-1001" title="Edit"><i class="fas fa-edit"></i></button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>TC-1002</td>
                                        <td>Verify login with invalid credentials</td>
                                        <td><span class="badge bg-success">Active</span></td>
                                        <td>John Doe</td>
                                        <td><span class="badge bg-info">Automated</span></td>
                                        <td>2025-04-25</td>
                                        <td>
                                            <div class="btn-group btn-group-sm" role="group">
                                                <button type="button" class="btn btn-outline-primary view-test-case" data-id="TC-1002" title="View"><i class="fas fa-eye"></i></button>
                                                <button type="button" class="btn btn-outline-success execute-test-case" data-id="TC-1002" title="Execute"><i class="fas fa-play"></i></button>
                                                <button type="button" class="btn btn-outline-warning edit-test-case" data-id="TC-1002" title="Edit"><i class="fas fa-edit"></i></button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>TC-1003</td>
                                        <td>Verify password recovery functionality</td>
                                        <td><span class="badge bg-warning">Under Maintenance</span></td>
                                        <td>Jane Smith</td>
                                        <td><span class="badge bg-info">Automated</span></td>
                                        <td>2025-04-20</td>
                                        <td>
                                            <div class="btn-group btn-group-sm" role="group">
                                                <button type="button" class="btn btn-outline-primary view-test-case" data-id="TC-1003" title="View"><i class="fas fa-eye"></i></button>
                                                <button type="button" class="btn btn-outline-success execute-test-case" data-id="TC-1003" title="Execute" disabled><i class="fas fa-play"></i></button>
                                                <button type="button" class="btn btn-outline-warning edit-test-case" data-id="TC-1003" title="Edit"><i class="fas fa-edit"></i></button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>TC-1004</td>
                                        <td>Verify user profile update</td>
                                        <td><span class="badge bg-success">Active</span></td>
                                        <td>Alex Wilson</td>
                                        <td><span class="badge bg-secondary">Manual</span></td>
                                        <td>2025-04-18</td>
                                        <td>
                                            <div class="btn-group btn-group-sm" role="group">
                                                <button type="button" class="btn btn-outline-primary view-test-case" data-id="TC-1004" title="View"><i class="fas fa-eye"></i></button>
                                                <button type="button" class="btn btn-outline-info notify-owner" data-id="TC-1004" title="Notify Owner"><i class="fas fa-bell"></i></button>
                                                <button type="button" class="btn btn-outline-warning edit-test-case" data-id="TC-1004" title="Edit"><i class="fas fa-edit"></i></button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>TC-1005</td>
                                        <td>Verify user account deletion</td>
                                        <td><span class="badge bg-danger">Obsolete</span></td>
                                        <td>John Doe</td>
                                        <td><span class="badge bg-secondary">Manual</span></td>
                                        <td>2025-03-15</td>
                                        <td>
                                            <div class="btn-group btn-group-sm" role="group">
                                                <button type="button" class="btn btn-outline-primary view-test-case" data-id="TC-1005" title="View"><i class="fas fa-eye"></i></button>
                                                <button type="button" class="btn btn-outline-info notify-owner" data-id="TC-1005" title="Notify Owner" disabled><i class="fas fa-bell"></i></button>
                                                <button type="button" class="btn btn-outline-warning edit-test-case" data-id="TC-1005" title="Edit" disabled><i class="fas fa-edit"></i></button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>TC-1006</td>
                                        <td>Verify checkout process</td>
                                        <td><span class="badge bg-success">Active</span></td>
                                        <td>Jane Smith</td>
                                        <td><span class="badge bg-info">Automated</span></td>
                                        <td>2025-04-24</td>
                                        <td>
                                            <div class="btn-group btn-group-sm" role="group">
                                                <button type="button" class="btn btn-outline-primary view-test-case" data-id="TC-1006" title="View"><i class="fas fa-eye"></i></button>
                                                <button type="button" class="btn btn-outline-success execute-test-case" data-id="TC-1006" title="Execute"><i class="fas fa-play"></i></button>
                                                <button type="button" class="btn btn-outline-warning edit-test-case" data-id="TC-1006" title="Edit"><i class="fas fa-edit"></i></button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>TC-1007</td>
                                        <td>Verify payment processing</td>
                                        <td><span class="badge bg-success">Active</span></td>
                                        <td>Alex Wilson</td>
                                        <td><span class="badge bg-info">Automated</span></td>
                                        <td>2025-04-22</td>
                                        <td>
                                            <div class="btn-group btn-group-sm" role="group">
                                                <button type="button" class="btn btn-outline-primary view-test-case" data-id="TC-1007" title="View"><i class="fas fa-eye"></i></button>
                                                <button type="button" class="btn btn-outline-success execute-test-case" data-id="TC-1007" title="Execute"><i class="fas fa-play"></i></button>
                                                <button type="button" class="btn btn-outline-warning edit-test-case" data-id="TC-1007" title="Edit"><i class="fas fa-edit"></i></button>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <nav aria-label="Test cases pagination">
                            <ul class="pagination justify-content-end">
                                <li class="page-item disabled">
                                    <a class="page-link" href="#" tabindex="-1" aria-disabled="true">Previous</a>
                                </li>
                                <li class="page-item active"><a class="page-link" href="#">1</a></li>
                                <li class="page-item"><a class="page-link" href="#">2</a></li>
                                <li class="page-item"><a class="page-link" href="#">3</a></li>
                                <li class="page-item">
                                    <a class="page-link" href="#">Next</a>
                                </li>
                            </ul>
                        </nav>
                    </div>
                    
                    <!-- Matched Cases Tab -->
                    <div class="tab-pane fade" id="matched-cases" role="tabpanel" aria-labelledby="matched-cases-tab">
                        <div class="table-responsive mt-3">
                            <table class="table table-striped table-hover" id="matched-cases-table">
                                <thead>
                                    <tr>
                                        <th scope="col">ID</th>
                                        <th scope="col">Title</th>
                                        <th scope="col">Matched With</th>
                                        <th scope="col">Owner</th>
                                        <th scope="col">Type</th>
                                        <th scope="col">Matched Date</th>
                                        <th scope="col">Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>TC-1001</td>
                                        <td>Verify login with valid credentials</td>
                                        <td>New_TC_001</td>
                                        <td>John Doe</td>
                                        <td><span class="badge bg-info">Automated</span></td>
                                        <td>2025-04-25</td>
                                        <td>
                                            <div class="btn-group btn-group-sm" role="group">
                                                <button type="button" class="btn btn-outline-primary view-match" data-id="TC-1001" title="View Match"><i class="fas fa-eye"></i></button>
                                                <button type="button" class="btn btn-outline-success execute-test-case" data-id="TC-1001" title="Execute"><i class="fas fa-play"></i></button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>TC-1002</td>
                                        <td>Verify login with invalid credentials</td>
                                        <td>New_TC_002</td>
                                        <td>John Doe</td>
                                        <td><span class="badge bg-info">Automated</span></td>
                                        <td>2025-04-25</td>
                                        <td>
                                            <div class="btn-group btn-group-sm" role="group">
                                                <button type="button" class="btn btn-outline-primary view-match" data-id="TC-1002" title="View Match"><i class="fas fa-eye"></i></button>
                                                <button type="button" class="btn btn-outline-success execute-test-case" data-id="TC-1002" title="Execute"><i class="fas fa-play"></i></button>
                                            </div>
                                        </td>
                                    </tr>
                                    <!-- Add more matched cases as needed -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- Cases Needing Modification Tab -->
                    <div class="tab-pane fade" id="needs-modification" role="tabpanel" aria-labelledby="needs-modification-tab">
                        <div class="table-responsive mt-3">
                            <table class="table table-striped table-hover" id="modification-cases-table">
                                <thead>
                                    <tr>
                                        <th scope="col">ID</th>
                                        <th scope="col">Title</th>
                                        <th scope="col">Change Suggestion</th>
                                        <th scope="col">Owner</th>
                                        <th scope="col">Type</th>
                                        <th scope="col">Suggested On</th>
                                        <th scope="col">Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>TC-1003</td>
                                        <td>Verify password recovery functionality</td>
                                        <td><span class="badge bg-warning">Step Updates</span></td>
                                        <td>Jane Smith</td>
                                        <td><span class="badge bg-info">Automated</span></td>
                                        <td>2025-04-20</td>
                                        <td>
                                            <div class="btn-group btn-group-sm" role="group">
                                                <button type="button" class="btn btn-outline-primary view-changes" data-id="TC-1003" title="View Changes"><i class="fas fa-eye"></i></button>
                                                <button type="button" class="btn btn-outline-success approve-changes" data-id="TC-1003" title="Approve"><i class="fas fa-check"></i></button>
                                                <button type="button" class="btn btn-outline-danger reject-changes" data-id="TC-1003" title="Reject"><i class="fas fa-times"></i></button>
                                            </div>
                                        </td>
                                    </tr>
                                    <!-- Add more cases needing modification as needed -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- Newly Added Cases Tab -->
                    <div class="tab-pane fade" id="new-cases" role="tabpanel" aria-labelledby="new-cases-tab">
                        <div class="table-responsive mt-3">
                            <table class="table table-striped table-hover" id="new-cases-table">
                                <thead>
                                    <tr>
                                        <th scope="col">ID</th>
                                        <th scope="col">Title</th>
                                        <th scope="col">Assigned Owner</th>
                                        <th scope="col">Type</th>
                                        <th scope="col">Added Date</th>
                                        <th scope="col">Status</th>
                                        <th scope="col">Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>TC-1008</td>
                                        <td>Verify order cancellation process</td>
                                        <td>Jane Smith</td>
                                        <td><span class="badge bg-secondary">Manual</span></td>
                                        <td>2025-04-25</td>
                                        <td><span class="badge bg-info">Pending Review</span></td>
                                        <td>
                                            <div class="btn-group btn-group-sm" role="group">
                                                <button type="button" class="btn btn-outline-primary view-test-case" data-id="TC-1008" title="View"><i class="fas fa-eye"></i></button>
                                                <button type="button" class="btn btn-outline-success approve-new-case" data-id="TC-1008" title="Approve"><i class="fas fa-check"></i></button>
                                                <button type="button" class="btn btn-outline-warning edit-test-case" data-id="TC-1008" title="Edit"><i class="fas fa-edit"></i></button>
                                            </div>
                                        </td>
                                    </tr>
                                    <!-- Add more newly added cases as needed -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Import Test Case Modal -->
<div class="modal fade" id="importTestCaseModal" tabindex="-1" aria-labelledby="importTestCaseModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="importTestCaseModalLabel">Import Test Case</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="mb-3">
                    <label for="importSource" class="form-label">Import Source</label>
                    <select class="form-select" id="importSource">
                        <option value="file">File Upload</option>
                        <option value="jira">JIRA</option>
                        <option value="alm">ALM</option>
                    </select>
                </div>
                
                <div id="fileUploadSection">
                    <div class="mb-3">
                        <label for="testCaseFile" class="form-label">Test Case File</label>
                        <input class="form-control" type="file" id="testCaseFile">
                        <div class="form-text">Supported formats: Excel, Word, CSV</div>
                    </div>
                </div>
                
                <div id="jiraSection" style="display: none;">
                    <div class="mb-3">
                        <label for="jiraProject" class="form-label">JIRA Project</label>
                        <select class="form-select" id="jiraProject">
                            <option value="">Select Project</option>
                            <option value="PROJ1">Project 1</option>
                            <option value="PROJ2">Project 2</option>
                            <option value="PROJ3">Project 3</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="jiraIssueType" class="form-label">Issue Type</label>
                        <select class="form-select" id="jiraIssueType">
                            <option value="">Select Issue Type</option>
                            <option value="testcase">Test Case</option>
                            <option value="story">User Story</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="jiraQuery" class="form-label">JQL Query (Optional)</label>
                        <input type="text" class="form-control" id="jiraQuery" placeholder="project = PROJ1 AND issuetype = 'Test Case'">
                    </div>
                </div>
                
                <div id="almSection" style="display: none;">
                    <div class="mb-3">
                        <label for="almProject" class="form-label">ALM Project</label>
                        <select class="form-select" id="almProject">
                            <option value="">Select Project</option>
                            <option value="ALM1">ALM Project 1</option>
                            <option value="ALM2">ALM Project 2</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="almFolder" class="form-label">Test Plan Folder</label>
                        <input type="text" class="form-control" id="almFolder" placeholder="Root\Folder\Subfolder">
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" id="importTestCaseBtn">Import</button>
            </div>
        </div>
    </div>
</div>

<!-- Compare with Repository Modal -->
<div class="modal fade" id="compareRepositoryModal" tabindex="-1" aria-labelledby="compareRepositoryModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="compareRepositoryModalLabel">Compare Test Case with Repository</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="mb-3">
                    <label for="compareSource" class="form-label">Source Test Case</label>
                    <select class="form-select" id="compareSource">
                        <option value="upload">Upload Test Case</option>
                        <option value="generate">Generated Test Case</option>
                    </select>
                </div>
                
                <div id="uploadTestCaseSection">
                    <div class="mb-3">
                        <label for="compareTestCaseFile" class="form-label">Test Case File</label>
                        <input class="form-control" type="file" id="compareTestCaseFile">
                        <div class="form-text">Supported formats: Excel, Word, CSV</div>
                    </div>
                </div>
                
                <div id="generatedTestCaseSection" style="display: none;">
                    <div class="mb-3">
                        <label for="generatedTestCase" class="form-label">Select Generated Test Case</label>
                        <select class="form-select" id="generatedTestCase">
                            <option value="">Select Test Case</option>
                            <option value="GEN001">Login Test Scenarios</option>
                            <option value="GEN002">User Profile Test Scenarios</option>
                            <option value="GEN003">Checkout Process Test Scenarios</option>
                        </select>
                    </div>
                </div>
                
                <div class="mt-4">
                    <button type="button" class="btn btn-primary" id="startComparisonBtn">Start Comparison</button>
                </div>
                
                <!-- Comparison Results Section (Initially Hidden) -->
                <div id="comparisonResultsSection" style="display: none;" class="mt-4">
                    <div class="alert alert-info comparison-status">
                        <i class="fas fa-search me-2"></i> Comparison completed. Showing results below.
                    </div>
                    
                    <div class="comparison-results-tabs">
                        <ul class="nav nav-tabs" id="comparisonTabs" role="tablist">
                            <li class="nav-item" role="presentation">
                                <button class="nav-link active" id="exact-match-tab" data-bs-toggle="tab" data-bs-target="#exact-match" type="button" role="tab" aria-controls="exact-match" aria-selected="true">
                                    Exact Match
                                </button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="partial-match-tab" data-bs-toggle="tab" data-bs-target="#partial-match" type="button" role="tab" aria-controls="partial-match" aria-selected="false">
                                    Partial Match
                                </button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="new-test-case-tab" data-bs-toggle="tab" data-bs-target="#new-test-case" type="button" role="tab" aria-controls="new-test-case" aria-selected="false">
                                    New Test Case
                                </button>
                            </li>
                        </ul>
                        <div class="tab-content" id="comparisonTabsContent">
                            <!-- Exact Match Tab -->
                            <div class="tab-pane fade show active" id="exact-match" role="tabpanel" aria-labelledby="exact-match-tab">
                                <div class="comparison-result-card mt-3">
                                    <div class="result-header bg-success-subtle p-3">
                                        <h5 class="m-0"><i class="fas fa-check-circle text-success me-2"></i> Exact Match Found</h5>
                                    </div>
                                    <div class="row g-0">
                                        <div class="col-md-6">
                                            <div class="p-3 border-end">
                                                <h6 class="mb-3">Source Test Case</h6>
                                                <div class="test-case-details">
                                                    <div class="mb-2"><strong>Title:</strong> Verify login with valid credentials</div>
                                                    <div class="test-case-steps">
                                                        <div class="step"><strong>Step 1:</strong> Navigate to login page</div>
                                                        <div class="step"><strong>Step 2:</strong> Enter valid username and password</div>
                                                        <div class="step"><strong>Step 3:</strong> Click on login button</div>
                                                        <div class="step"><strong>Step 4:</strong> Verify user is logged in successfully</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="p-3">
                                                <h6 class="mb-3">Matched Repository Test Case</h6>
                                                <div class="test-case-details">
                                                    <div class="mb-2"><strong>ID:</strong> TC-1001</div>
                                                    <div class="mb-2"><strong>Title:</strong> Verify login with valid credentials</div>
                                                    <div class="mb-2"><strong>Owner:</strong> John Doe</div>
                                                    <div class="mb-2"><strong>Type:</strong> <span class="badge bg-info">Automated</span></div>
                                                    <div class="mb-2"><strong>Status:</strong> <span class="badge bg-success">Active</span></div>
                                                    <div class="mb-2"><strong>Test Data Status:</strong> <span class="badge bg-success">Available</span></div>
                                                    <div class="test-case-steps">
                                                        <div class="step"><strong>Step 1:</strong> Navigate to login page</div>
                                                        <div class="step"><strong>Step 2:</strong> Enter valid username and password</div>
                                                        <div class="step"><strong>Step 3:</strong> Click on login button</div>
                                                        <div class="step"><strong>Step 4:</strong> Verify user is logged in successfully</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="exact-match-actions p-3 border-top">
                                        <div class="row align-items-center">
                                            <div class="col-md-8">
                                                <div class="d-flex align-items-center">
                                                    <span class="me-3">This test case is already in the repository and no changes are needed.</span>
                                                </div>
                                            </div>
                                            <div class="col-md-4 text-end">
                                                <button class="btn btn-success me-2" id="triggerExecutionBtn">
                                                    <i class="fas fa-play me-1"></i> Trigger Execution
                                                </button>
                                                <button class="btn btn-primary" id="updateMatchedListBtn">
                                                    <i class="fas fa-list-check me-1"></i> Update Matched List
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Partial Match Tab -->
                            <div class="tab-pane fade" id="partial-match" role="tabpanel" aria-labelledby="partial-match-tab">
                                <div class="comparison-result-card mt-3">
                                    <div class="result-header bg-warning-subtle p-3">
                                        <h5 class="m-0"><i class="fas fa-exclamation-circle text-warning me-2"></i> Partial Match Found</h5>
                                    </div>
                                    <div class="row g-0">
                                        <div class="col-md-6">
                                            <div class="p-3 border-end">
                                                <h6 class="mb-3">Source Test Case</h6>
                                                <div class="test-case-details">
                                                    <div class="mb-2"><strong>Title:</strong> Verify password recovery functionality</div>
                                                    <div class="test-case-steps">
                                                        <div class="step"><strong>Step 1:</strong> Navigate to login page</div>
                                                        <div class="step"><strong>Step 2:</strong> Click on "Forgot Password" link</div>
                                                        <div class="step"><strong>Step 3:</strong> Enter registered email address</div>
                                                        <div class="step"><strong>Step 4:</strong> Click on "Reset Password" button</div>
                                                        <div class="step"><strong>Step 5:</strong> Verify reset link sent email notification</div>
                                                        <div class="step"><strong>Step 6:</strong> Click on the reset link in email</div>
                                                        <div class="step highlight-diff"><strong>Step 7:</strong> Enter new password and confirm password</div>
                                                        <div class="step highlight-diff"><strong>Step 8:</strong> Click on "Save New Password" button</div>
                                                        <div class="step highlight-diff"><strong>Step 9:</strong> Verify successful password change notification</div>
                                                        <div class="step highlight-diff"><strong>Step 10:</strong> Login with new password</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="p-3">
                                                <h6 class="mb-3">Matched Repository Test Case</h6>
                                                <div class="test-case-details">
                                                    <div class="mb-2"><strong>ID:</strong> TC-1003</div>
                                                    <div class="mb-2"><strong>Title:</strong> Verify password recovery functionality</div>
                                                    <div class="mb-2"><strong>Owner:</strong> Jane Smith</div>
                                                    <div class="mb-2"><strong>Type:</strong> <span class="badge bg-info">Automated</span></div>
                                                    <div class="mb-2"><strong>Status:</strong> <span class="badge bg-warning">Under Maintenance</span></div>
                                                    <div class="test-case-steps">
                                                        <div class="step"><strong>Step 1:</strong> Navigate to login page</div>
                                                        <div class="step"><strong>Step 2:</strong> Click on "Forgot Password" link</div>
                                                        <div class="step"><strong>Step 3:</strong> Enter registered email address</div>
                                                        <div class="step"><strong>Step 4:</strong> Click on "Reset Password" button</div>
                                                        <div class="step"><strong>Step 5:</strong> Verify reset link sent email notification</div>
                                                        <div class="step"><strong>Step 6:</strong> Click on the reset link in email</div>
                                                        <div class="step highlight-missing"><strong>Step 7:</strong> Enter new password</div>
                                                        <div class="step highlight-missing"><strong>Step 8:</strong> Click on "Submit" button</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="partial-match-actions p-3 border-top">
                                        <div class="d-flex justify-content-between align-items-center">
                                            <div>
                                                <p class="mb-0"><strong>Suggested Changes:</strong> This test case needs steps added for confirming password and verifying login with new password.</p>
                                            </div>
                                            <div>
                                                <button class="btn btn-info me-2" id="notifyOwnerBtn">
                                                    <i class="fas fa-bell me-1"></i> Notify Owner
                                                </button>
                                                <button class="btn btn-warning me-2" id="uploadNewVersionBtn">
                                                    <i class="fas fa-upload me-1"></i> Upload New Version
                                                </button>
                                                <button class="btn btn-primary" id="updateModificationListBtn">
                                                    <i class="fas fa-list-check me-1"></i> Update Modification List
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- New Test Case Tab -->
                            <div class="tab-pane fade" id="new-test-case" role="tabpanel" aria-labelledby="new-test-case-tab">
                                <div class="comparison-result-card mt-3">
                                    <div class="result-header bg-info-subtle p-3">
                                        <h5 class="m-0"><i class="fas fa-plus-circle text-info me-2"></i> New Test Case</h5>
                                    </div>
                                    <div class="p-3">
                                        <h6 class="mb-3">New Test Case Details</h6>
                                        <div class="test-case-details">
                                            <div class="mb-2"><strong>Title:</strong> Verify order cancellation process</div>
                                            <div class="test-case-steps mb-3">
                                                <div class="step"><strong>Step 1:</strong> Login to the application</div>
                                                <div class="step"><strong>Step 2:</strong> Navigate to My Orders section</div>
                                                <div class="step"><strong>Step 3:</strong> Select an order to cancel</div>
                                                <div class="step"><strong>Step 4:</strong> Click on "Cancel Order" button</div>
                                                <div class="step"><strong>Step 5:</strong> Select a reason for cancellation</div>
                                                <div class="step"><strong>Step 6:</strong> Confirm cancellation</div>
                                                <div class="step"><strong>Step 7:</strong> Verify order status is updated to "Cancelled"</div>
                                                <div class="step"><strong>Step 8:</strong> Verify cancellation confirmation email is received</div>
                                            </div>
                                            
                                            <div class="mb-3">
                                                <label for="testCaseType" class="form-label">Test Case Type</label>
                                                <select class="form-select" id="testCaseType">
                                                    <option value="manual">Manual</option>
                                                    <option value="automated">Automated</option>
                                                </select>
                                            </div>
                                            
                                            <div class="rule-preview p-3 mb-3 bg-light border rounded">
                                                <h6 class="mb-2">Owner Assignment Rule Preview</h6>
                                                <p class="mb-0"><strong>Assigned Owner:</strong> Jane Smith</p>
                                                <p class="mb-0"><small class="text-muted">Based on rule: "Order Management" module test cases are assigned to Jane Smith</small></p>
                                                <button class="btn btn-sm btn-link" data-bs-toggle="modal" data-bs-target="#editRulesModal">Edit Rules</button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="new-case-actions p-3 border-top">
                                        <div class="d-flex justify-content-end">
                                            <button class="btn btn-success me-2" id="uploadRepositoryBtn">
                                                <i class="fas fa-upload me-1"></i> Upload to Repository & Assign Owner
                                            </button>
                                            <button class="btn btn-primary" id="updateNewListBtn">
                                                <i class="fas fa-list-check me-1"></i> Update New List
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<!-- View Test Case Modal -->
<div class="modal fade" id="viewTestCaseModal" tabindex="-1" aria-labelledby="viewTestCaseModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="viewTestCaseModalLabel">Test Case Details</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="test-case-container">
                    <div class="test-case-header mb-3">
                        <div class="row">
                            <div class="col-md-6">
                                <h5 id="viewTestCaseTitle">Verify login with valid credentials</h5>
                                <p class="mb-1"><strong>ID:</strong> <span id="viewTestCaseId">TC-1001</span></p>
                            </div>
                            <div class="col-md-6 text-md-end">
                                <span class="badge bg-success mb-1" id="viewTestCaseStatus">Active</span>
                                <span class="badge bg-info mb-1" id="viewTestCaseType">Automated</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="test-case-metadata mb-3">
                        <div class="row">
                            <div class="col-md-4">
                                <p class="mb-1"><strong>Owner:</strong> <span id="viewTestCaseOwner">John Doe</span></p>
                            </div>
                            <div class="col-md-4">
                                <p class="mb-1"><strong>Created Date:</strong> <span id="viewTestCaseCreated">2025-03-15</span></p>
                            </div>
                            <div class="col-md-4">
                                <p class="mb-1"><strong>Last Modified:</strong> <span id="viewTestCaseModified">2025-04-25</span></p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="test-case-details mb-3">
                        <h6>Description</h6>
                        <p id="viewTestCaseDescription">This test case verifies that a user can successfully log in to the application using valid credentials.</p>
                    </div>
                    
                    <div class="test-case-steps mb-3">
                        <h6>Test Steps</h6>
                        <div class="table-responsive">
                            <table class="table table-bordered" id="viewTestCaseStepsTable">
                                <thead>
                                    <tr>
                                        <th width="5%">#</th>
                                        <th width="45%">Action</th>
                                        <th width="25%">Expected Result</th>
                                        <th width="25%">Test Data</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>1</td>
                                        <td>Navigate to login page</td>
                                        <td>Login page is displayed</td>
                                        <td>App URL: https://example.com/login</td>
                                    </tr>
                                    <tr>
                                        <td>2</td>
                                        <td>Enter valid username and password</td>
                                        <td>Credentials are entered in the respective fields</td>
                                        <td>Username: testuser<br>Password: Test@123</td>
                                    </tr>
                                    <tr>
                                        <td>3</td>
                                        <td>Click on login button</td>
                                        <td>System processes the login request</td>
                                        <td>N/A</td>
                                    </tr>
                                    <tr>
                                        <td>4</td>
                                        <td>Verify user is logged in successfully</td>
                                        <td>Home page is displayed with user profile information visible</td>
                                        <td>Expected welcome message: "Welcome, Test User"</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="test-case-execution mb-3">
                        <h6>Execution History</h6>
                        <div class="table-responsive">
                            <table class="table table-bordered table-sm" id="viewTestCaseExecutionTable">
                                <thead>
                                    <tr>
                                        <th>Run ID</th>
                                        <th>Date</th>
                                        <th>Executed By</th>
                                        <th>Status</th>
                                        <th>Duration</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>RUN-1001</td>
                                        <td>2025-04-25</td>
                                        <td>System</td>
                                        <td><span class="badge bg-success">Passed</span></td>
                                        <td>2.5s</td>
                                    </tr>
                                    <tr>
                                        <td>RUN-982</td>
                                        <td>2025-04-20</td>
                                        <td>System</td>
                                        <td><span class="badge bg-success">Passed</span></td>
                                        <td>2.3s</td>
                                    </tr>
                                    <tr>
                                        <td>RUN-943</td>
                                        <td>2025-04-15</td>
                                        <td>System</td>
                                        <td><span class="badge bg-danger">Failed</span></td>
                                        <td>3.1s</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-warning" id="editTestCaseBtn"><i class="fas fa-edit me-1"></i> Edit</button>
                <button type="button" class="btn btn-success" id="executeTestCaseModalBtn"><i class="fas fa-play me-1"></i> Execute</button>
            </div>
        </div>
    </div>
</div>

<!-- Edit Rules Modal -->
<div class="modal fade" id="editRulesModal" tabindex="-1" aria-labelledby="editRulesModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editRulesModalLabel">Edit Owner Assignment Rules</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="mb-3">
                    <label class="form-label">Rule Priority Order</label>
                    <div class="rules-list">
                        <div class="rule-item d-flex align-items-center mb-2">
                            <div class="rule-drag-handle me-2"><i class="fas fa-grip-vertical"></i></div>
                            <div class="rule-content flex-grow-1">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="rule1" checked>
                                    <label class="form-check-label" for="rule1">
                                        "Login" module test cases are assigned to John Doe
                                    </label>
                                </div>
                            </div>
                            <div class="rule-actions">
                                <button class="btn btn-sm btn-link edit-rule"><i class="fas fa-edit"></i></button>
                            </div>
                        </div>
                        <div class="rule-item d-flex align-items-center mb-2">
                            <div class="rule-drag-handle me-2"><i class="fas fa-grip-vertical"></i></div>
                            <div class="rule-content flex-grow-1">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="rule2" checked>
                                    <label class="form-check-label" for="rule2">
                                        "User Profile" module test cases are assigned to Alex Wilson
                                    </label>
                                </div>
                            </div>
                            <div class="rule-actions">
                                <button class="btn btn-sm btn-link edit-rule"><i class="fas fa-edit"></i></button>
                            </div>
                        </div>
                        <div class="rule-item d-flex align-items-center mb-2">
                            <div class="rule-drag-handle me-2"><i class="fas fa-grip-vertical"></i></div>
                            <div class="rule-content flex-grow-1">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="rule3" checked>
                                    <label class="form-check-label" for="rule3">
                                        "Order Management" module test cases are assigned to Jane Smith
                                    </label>
                                </div>
                            </div>
                            <div class="rule-actions">
                                <button class="btn btn-sm btn-link edit-rule"><i class="fas fa-edit"></i></button>
                            </div>
                        </div>
                        <div class="rule-item d-flex align-items-center mb-2">
                            <div class="rule-drag-handle me-2"><i class="fas fa-grip-vertical"></i></div>
                            <div class="rule-content flex-grow-1">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="rule4" checked>
                                    <label class="form-check-label" for="rule4">
                                        Default rule: Assign to QA Lead (Jane Smith)
                                    </label>
                                </div>
                            </div>
                            <div class="rule-actions">
                                <button class="btn btn-sm btn-link edit-rule"><i class="fas fa-edit"></i></button>
                            </div>
                        </div>
                    </div>
                </div>
                <button class="btn btn-sm btn-primary">
                    <i class="fas fa-plus me-1"></i> Add New Rule
                </button>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary">Save Rules</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/test_repository/test_repository.js' %}"></script>
{% endblock %}